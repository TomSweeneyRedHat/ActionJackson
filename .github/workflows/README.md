# Automated Release Workflow README.md

The workflow in the action_release.yml automates the process of creating a new GitHub Release whenever a version tag is pushed to the repository. It uses a series of community actions to handle code checkout, release note generation, and release creation.

It also allows for a manual creation of the release from the GitHub Actions page of the repository.

This workflow heavily leveraged the [release](https://github.com/containers/podman/blob/main/.github/workflows/release.yml) workflow in Podman.  This README.md was
initially generated by Gemini, and then gently massaged.

## üöÄ Workflow Purpose

The `action_release.yml` file defines a job that automatically:

1.  Checks out the code corresponding to the pushed tag.
2.  Generates structured release notes by analyzing merged Pull Requests between the previous tag and the new tag.
3.  Creates an official GitHub Release using the newly generated notes as the release description.

## ‚öôÔ∏è How to Use It

This workflow is **event-driven**, meaning you do not need to manually trigger it from the GitHub Actions tab. It is triggered by pushing a new Git tag.

It can also be triggered "by hand" if so desired.  
### Triggering the Release
#### Automatic Triggering
To run the workflow and create a new release, follow these steps in your local repository:

1.  **Create a New Tag:** Use the `git tag` command to create an annotated tag for your new version (e.g., `v1.2.3`).

    ```bash
    git tag -a v1.2.3 -m "Release version 1.2.3"
    ```

2.  **Push the Tag:** Push the tag to your GitHub repository.

    ```bash
    git push origin v1.2.3
    ```

Once the tag is pushed, GitHub will automatically detect the event and start the **Action Release** workflow.

#### Manual Triggering

In the event of a need to recreate a release, a GitHub Action can be run manually, as long as a tag exists for it.  Go to `https://github.com/{ProjectName}/actions` and select
the "release" workflow in the left windowpane.  Once selected, a new window will come up with a `Run workflow` button.  Click on this, and answer
the following questions in the form:

  * **Branch:** Select the branch of the project that you want to create the release from.
  * **Release Version to build and upload:** Enter the version number for the already created tag in the project to build the release from.  It should be of the form `v.X.Y.Z`, or `v1.24.15`, for example.
  * **Build only: Do not create the release** This defaults to `true`, allowing you to do the preliminary checking to see if everything is in place to build the release.  If you select `true`, the release will **NOT** be built.  If you select `false`, the release will attempt to build.
  * **Generate Release Note or pull from RELEASE_NOTES.md?** This defaults to `generate`.  This will then use the default GitHub release action to generate the Release Note from the release, using the information found in `git log`.  This does **NOT** write the information to the project's `RELEASE_NOTES.md` file.  This will have to be done afterward this runs, if that is desired.  If you select `pull`, this action will look for an entry in the project's `RELEASE_NOTES.md` file with the heading `X.Y.Z` that corresponds to the release being created.  These notes will then be used for the release text on the Releases page.
  * **Send Mail to podman@lists.podman.io** This defaults to `false`.  If set to true, an email will be generated and sent to the podman@lists.podman.io page announcing the new release for the project. 

## üîë Permissions and Requirements

This workflow requires elevated permissions to interact with the GitHub API for generating notes and creating the release object.

To ensure the workflow runs successfully, the job configuration must include the following permissions block, granting the default `GITHUB_TOKEN` the ability to write:

```yaml
jobs:
  release:
    runs-on: ubuntu-latest
    permissions:
      contents: write # REQUIRED to create the release and fetch content
    steps:
      # ...
üß© Key Actions Used (Inferred)
The automation process relies on the following GitHub Actions:

Action Name	Purpose
actions/checkout@v4	Downloads a copy of the repository code to the runner.
gableroux/generate-github-release-notes@v0.1.2	Generates the Markdown content for the release notes based on the commit history and merged PRs between tags.
softprops/action-gh-release@v1	Creates the final GitHub Release, publishing the generated notes using the pushed tag name.

Export to Sheets
üõë Troubleshooting
If the workflow fails with an error, such as the AxiosError: Request failed with status code 404 (a common GitHub API error in release actions), consider the following:

Check Permissions: Ensure your workflow or specific job has explicitly set permissions: contents: write to allow the default GITHUB_TOKEN to create the release.

Verify Tags: Confirm that the tag you pushed exactly matches the pattern the workflow is listening for (e.g., v*).

Previous Tag Existence: For release note generation to work correctly, a previous tag must exist to define the change range. Ensure your repository has at least one prior version tag.
